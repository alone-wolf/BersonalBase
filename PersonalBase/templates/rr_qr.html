{% extends "template.html" %}

{% block title %}
    RR QRCode
{% endblock %}


{% block addition_css %}
{% endblock %}

{% block addition_js %}
<script src="/static/recrepo/qrcode/qrcode.min.js"></script>
<script>
    var protocol = window.location.protocol;
    var domain = window.location.host;
    var token = getQueryVariable("token");

    if (token == false || token == "") {
        location.href = "/err";
    }

    var urlstr = protocol + "//" + domain + "/rr/stage?token=" + token;

    var qr_doce_div = document.createElement('div');
    qr_doce_div.setAttribute('style', 'margin-top:7px;border:5px solid white;width:100px;align:center');

    var qrcode = new QRCode(qr_doce_div, { width: 400, height: 400 });
    qrcode.makeCode(urlstr);

    var card = document.getElementById("ppp");
    card.appendChild(qr_doce_div);
    document.getElementById("hhh").appendChild(document.createTextNode(" "+urlstr));

    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) { return pair[1]; }
        }
        return (false);
    }
</script>
{% endblock %}

{% block header %}
    <div class="page-header">
        <h1>RR QRCode</h1>
    </div>
{% endblock %}

{% block body %}

    <div class="panel panel-warning" style="margin: 16px;">
        <div class="panel-heading">
            <h3 class="panel-title" id="hhh">QR Code Stage</h3>
        </div>
        <div class="panel-body" id="ppp">

        </div>
    </div>

{% endblock %}

{% block foot %}
{% endblock %}